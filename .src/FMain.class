' Gambas class file


Public Sub SliderBox1_Change()

  If SliderBox1.Value = SliderBox1.MaxValue Then 
    SliderBox1.MaxValue += 50
  Endif

End

Public Sub Form_Show()

  ListView1.Add("1", "Joel")
  ListView1.Add("2", "Max")
  ListView1.Add("3", "Shane")
  Me.Center
  TextBox1.SetFocus
  Global.DB_Filename = Settings["Database/Filename", ""]
  If Exist(Global.DB_Filename) Then 
    Global.OpenDb()
  Else 
    Menu2_Click
  Endif 
  
End

Public Sub Menu2_Click()

  Dialog.Title = "Choose a file"
Dialog.Filter = ["*.txt", "Text Files", "*", "All files"]
Dialog.Path = "."
If Dialog.OpenFile() Then
  Return ' User pressed Cancel -
Endif
  Global.DB_Filename = Dialog.Path
  Settings["Database/Filename"] = Dialog.Path
  Settings.Save
  Global.OpenDb()
  
End

Public Sub TextBox1_Change()

  Timer1.Enabled = False
  Timer1.Enabled = True
  ' ' Check for delimiter (e.g., carriage return or newline)
  ' If InStr(TextBox1.Text, Chr(13)) > 0 Then
  '   ' Find the barcode text before the delimiter
  '   Dim barcode As String
  '   barcode = Mid(TextBox1.Text, 1, InStr(TextBox1.Text, Chr(13)) - 1)
  '   
  '   ' Process the barcode
  '   'ProcessBarcode(barcode)
  '   Global.Find_Product(barcode)
  '   ' Clear the TextBox after processing
  '   TextBox1.Text = ""
  ' Endif

End


Public Sub Timer1_Timer()
Dim res As Result
  ' Stop the timer to prevent repeated triggers
  Timer1.Enabled = False
  
  ' Process the barcode input
  If TextBox1.Text <> "" Then
    res = Global.Find_Product(TextBox1.Text)
    If res.Available Then   
      If res!image <> Null Then
         PictureBox1.Picture = Global.Scale_Picture(Global.Load_Picture_Blob(res!image), PictureBox1.Width, PictureBox1.Height, True)
      Endif
     Endif 
      
    ' TextBox1.Text = ""
    ' TextBox1.SetFocus  
  Endif

  
 

End

Public Sub Button1_Click()

  TextBox1.Text = ""
  SliderBox1.MaxValue = 100
  SliderBox1.Value = 0
  PictureBox1.Picture = Null
  TextBox1.SetFocus

End
